@import '../../styles/base/animations';

/* 隐藏原生 input */
.nativeInput {
    position: absolute;
    opacity: 0;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    margin: 0;
    cursor: pointer;
    z-index: 1;
}

/* 基础容器 - 需要相对定位 */
.checkboxContainer {
    position: relative;
    display: inline-flex;
    align-items: flex-start;
    gap: 12px;
    cursor: pointer;
    user-select: none;
    transition: all 0.2s ease;
    padding: 4px 0;

    /* 尺寸变体 */
    &.small {
        font-size: 14px;
    }

    &.medium {
        font-size: 16px;
    }

    &.large {
        font-size: 18px;
    }

    /* 自定义复选框 */
    .checkbox {
        position: relative;
        flex-shrink: 0;
        width: 20px;
        height: 20px;
        /* 【修正1】使用正确的边框和背景变量 */
        border: 2px solid var(--olympus-border-primary);
        border-radius: 6px;
        background: var(--olympus-bg-secondary);
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 0;

        /* 选中图标 */
        .checkmark {
            width: 12px;
            height: 10px;
            color: white;
            stroke-width: 2;
            opacity: 0; /* 默认隐藏 */
            transition: opacity 0.2s ease;
        }

        /* 不确定状态 */
        .indeterminateMark {
            color: white;
            font-weight: bold;
            font-size: 14px;
            line-height: 1;
            opacity: 0; /* 默认隐藏 */
            transition: opacity 0.2s ease;
        }

        /* 加载状态 */
        .loadingIndicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);

            .spinner {
                width: 12px;
                height: 12px;
                border: 2px solid transparent;
                /* 【修正2】加载动画使用主色 */
                border-top: 2px solid var(--olympus-primary);
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }
        }
    }

    /* 内容区域 */
    .content {
        flex: 1;
        min-width: 0;

        .label {
            display: flex;
            align-items: center;
            gap: 8px;
            /* 【修正3】使用主要文本色 */
            color: var(--olympus-text-primary);
            line-height: 1.4;
            font-weight: 500;

            .contractBadge {
                font-size: 12px;
                opacity: 0.7;
                color: var(--olympus-text-secondary);
            }

            .riskBadge {
                &[data-risk='high'] {
                    color: var(--olympus-error); /* 【修正4】使用错误色 */
                }
                
                &[data-risk='medium'] {
                    color: var(--olympus-warning); /* 使用警告色 */
                }
                
                &[data-risk='low'] {
                    color: var(--olympus-success); /* 使用成功色 */
                }
            }
        }

        .description {
            margin-top: 4px;
            font-size: 14px;
            /* 【修正5】使用次要文本色 */
            color: var(--olympus-text-secondary);
            line-height: 1.4;
        }
    }

    /* 选中状态 */
    &.checked {
        .checkbox {
            background: var(--olympus-primary);
            border-color: var(--olympus-primary);
            
            .checkmark {
                opacity: 1; /* 显示勾选图标 */
            }
        }
    }

    /* 不确定状态 */
    &.indeterminate {
        .checkbox {
            background: var(--olympus-primary);
            border-color: var(--olympus-primary);
            
            .indeterminateMark {
                opacity: 1; /* 显示不确定标记 */
            }
        }
    }

    /* 交互状态 */
    &:not(.disabled):not(.loading):hover {
        .checkbox {
            border-color: var(--olympus-primary);
            /* 【修正6】使用RGB变量创建阴影 */
            box-shadow: 0 0 0 3px rgba(var(--olympus-primary-rgb), 0.1);
        }
    }

    /* 合约交互样式 */
    &.contractInteraction {
        .checkbox {
            border-style: dashed;
            border-color: var(--olympus-primary);
        }
    }

    /* 禁用状态 */
    &.disabled {
        cursor: not-allowed;
        opacity: 0.6;
        
        .checkbox {
            background: var(--olympus-bg-tertiary);
            border-color: var(--olympus-border-primary);
        }
        
        .label,
        .description {
            color: var(--olympus-text-tertiary);
        }
    }

    /* 加载状态 */
    &.loading {
        .checkbox {
            .checkmark,
            .indeterminateMark {
                opacity: 0; /* 隐藏普通图标，显示加载动画 */
            }
        }
    }
}